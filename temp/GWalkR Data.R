# install.packages("GWalkR")
 setwd("C:/2024ICBT/")
library(GWalkR)
library(dplyr)

final_data_toLoad <- paste('Data_final/','icbt_data.RDS' , sep = '')
final_error_toLoad <- paste('Data_final/','error_data.RDS' , sep = '')


icbt_data <- readRDS(final_data_toLoad) %>% select(
  RegionName,
  districtName,
  dates,month,quarter,
  transpondent_id,tradeDirection,sex,
  transportMeans,
  transportMeans_otherSpecify,
  productObserved,commodity_isLivestock,commodityQuantity,CommodityPrice
)
# %>% slice(1:500)

gwalkr(icbt_data)
# gwalkr(icbt_data, kernelComputation = TRUE)

# [{"config":{"defaultAggregated":true,"geoms":["auto"],"coordSystem":"generic","limit":-1},"encodings":{"dimensions":[{"fid":"UmVnaW9uTmFtZQ==","name":"RegionName","basename":"RegionName","semanticType":"nominal","analyticType":"dimension"},{"fid":"ZGlzdHJpY3RDb2Rl","name":"districtCode","basename":"districtCode","semanticType":"nominal","analyticType":"dimension"},{"fid":"ZGlzdHJpY3ROYW1l","name":"districtName","basename":"districtName","semanticType":"nominal","analyticType":"dimension"},{"fid":"dG93bkNpdHk=","name":"townCity","basename":"townCity","semanticType":"nominal","analyticType":"dimension"},{"fid":"Ym9yZGVyUG9zdE5hbWU=","name":"borderPostName","basename":"borderPostName","semanticType":"nominal","analyticType":"dimension"},{"fid":"aW50ZXJ2aWV3X2tleQ==","name":"interview_key","basename":"interview_key","semanticType":"nominal","analyticType":"dimension"},{"fid":"aW50ZXJ2aWV3X2lk","name":"interview_id","basename":"interview_id","semanticType":"nominal","analyticType":"dimension"},{"fid":"ZW51bWVyYXRvcl9uYW1l","name":"enumerator_name","basename":"enumerator_name","semanticType":"nominal","analyticType":"dimension"},{"fid":"ZW51bWVyYXRvcl9jb250YWN0","name":"enumerator_contact","basename":"enumerator_contact","semanticType":"nominal","analyticType":"dimension"},{"fid":"b2JzZXJ2ZWRSZXNwb25kZW50RGVzY3JpcHRpb24=","name":"observedRespondentDescription","basename":"observedRespondentDescription","semanticType":"nominal","analyticType":"dimension"},{"fid":"Y29tbW9kaXR5T2JlcnZlZERlc2NyaXB0aW9u","name":"commodityObervedDescription","basename":"commodityObervedDescription","semanticType":"nominal","analyticType":"dimension"},{"fid":"ZXJyb3JDaGVjaw==","name":"errorCheck","basename":"errorCheck","semanticType":"nominal","analyticType":"dimension"},{"fid":"ZXJyb3JNZXNzYWdl","name":"errorMessage","basename":"errorMessage","semanticType":"nominal","analyticType":"dimension"},{"fid":"Z3BzX1RpbWVzdGFtcA==","name":"gps_Timestamp","basename":"gps_Timestamp","semanticType":"nominal","analyticType":"dimension"},{"fid":"cmVzcG9uc2libGVJZA==","name":"responsibleId","basename":"responsibleId","semanticType":"nominal","analyticType":"dimension"},{"fid":"Y3JlYXRlZERhdGU=","name":"createdDate","basename":"createdDate","semanticType":"nominal","analyticType":"dimension"},{"fid":"ZGF0ZXM=","name":"dates","basename":"dates","semanticType":"temporal","analyticType":"dimension"},{"fid":"bW9udGg=","name":"month","basename":"month","semanticType":"nominal","analyticType":"dimension"},{"fid":"gw_mea_key_fid","name":"Measure names","analyticType":"dimension","semanticType":"nominal"}],"measures":[{"fid":"cmVnaW9uQ29kZQ==","name":"regionCode","basename":"regionCode","analyticType":"measure","semanticType":"quantitative","aggName":"sum"},{"fid":"dGVhbV9udW1iZXI=","name":"team_number","basename":"team_number","analyticType":"measure","semanticType":"quantitative","aggName":"sum"},{"fid":"dHJhbnNwb25kZW50X2lk","name":"transpondent_id","basename":"transpondent_id","analyticType":"measure","semanticType":"quantitative","aggName":"sum"},{"fid":"Q29tbW9kaXR5X2lk","name":"Commodity_id","basename":"Commodity_id","analyticType":"measure","semanticType":"quantitative","aggName":"sum"},{"fid":"eWVhcg==","name":"year","basename":"year","analyticType":"measure","semanticType":"quantitative","aggName":"sum"},{"fid":"gw_count_fid","name":"Row count","analyticType":"measure","semanticType":"quantitative","aggName":"sum","computed":true,"expression":{"op":"one","params":[],"as":"gw_count_fid"}},{"fid":"gw_mea_val_fid","name":"Measure values","analyticType":"measure","semanticType":"quantitative","aggName":"sum"}],"rows":[{"fid":"UmVnaW9uTmFtZQ==","name":"RegionName","basename":"RegionName","semanticType":"nominal","analyticType":"dimension"}],"columns":[{"fid":"gw_count_fid","name":"Row count","analyticType":"measure","semanticType":"quantitative","aggName":"sum","computed":true,"expression":{"op":"one","params":[],"as":"gw_count_fid"}}],"color":[{"fid":"ZXJyb3JDaGVjaw==","name":"errorCheck","basename":"errorCheck","semanticType":"nominal","analyticType":"dimension"}],"opacity":[],"size":[],"shape":[],"radius":[],"theta":[],"longitude":[],"latitude":[],"geoId":[],"details":[],"filters":[],"text":[]},"layout":{"showActions":false,"showTableSummary":false,"stack":"none","interactiveScale":false,"zeroScale":true,"size":{"mode":"full","width":320,"height":200},"format":{},"geoKey":"name","resolve":{"x":false,"y":false,"color":false,"opacity":false,"shape":false,"size":false}},"visId":"gw_cdfW","name":"Chart 1"},{"config":{"defaultAggregated":true,"geoms":["auto"],"coordSystem":"generic","limit":-1},"encodings":{"dimensions":[{"fid":"UmVnaW9uTmFtZQ==","name":"RegionName","basename":"RegionName","semanticType":"nominal","analyticType":"dimension"},{"fid":"ZGlzdHJpY3RDb2Rl","name":"districtCode","basename":"districtCode","semanticType":"nominal","analyticType":"dimension"},{"fid":"ZGlzdHJpY3ROYW1l","name":"districtName","basename":"districtName","semanticType":"nominal","analyticType":"dimension"},{"fid":"dG93bkNpdHk=","name":"townCity","basename":"townCity","semanticType":"nominal","analyticType":"dimension"},{"fid":"Ym9yZGVyUG9zdE5hbWU=","name":"borderPostName","basename":"borderPostName","semanticType":"nominal","analyticType":"dimension"},{"fid":"aW50ZXJ2aWV3X2tleQ==","name":"interview_key","basename":"interview_key","semanticType":"nominal","analyticType":"dimension"},{"fid":"aW50ZXJ2aWV3X2lk","name":"interview_id","basename":"interview_id","semanticType":"nominal","analyticType":"dimension"},{"fid":"ZW51bWVyYXRvcl9uYW1l","name":"enumerator_name","basename":"enumerator_name","semanticType":"nominal","analyticType":"dimension"},{"fid":"ZW51bWVyYXRvcl9jb250YWN0","name":"enumerator_contact","basename":"enumerator_contact","semanticType":"nominal","analyticType":"dimension"},{"fid":"b2JzZXJ2ZWRSZXNwb25kZW50RGVzY3JpcHRpb24=","name":"observedRespondentDescription","basename":"observedRespondentDescription","semanticType":"nominal","analyticType":"dimension"},{"fid":"Y29tbW9kaXR5T2JlcnZlZERlc2NyaXB0aW9u","name":"commodityObervedDescription","basename":"commodityObervedDescription","semanticType":"nominal","analyticType":"dimension"},{"fid":"ZXJyb3JDaGVjaw==","name":"errorCheck","basename":"errorCheck","semanticType":"nominal","analyticType":"dimension"},{"fid":"ZXJyb3JNZXNzYWdl","name":"errorMessage","basename":"errorMessage","semanticType":"nominal","analyticType":"dimension"},{"fid":"Z3BzX1RpbWVzdGFtcA==","name":"gps_Timestamp","basename":"gps_Timestamp","semanticType":"nominal","analyticType":"dimension"},{"fid":"cmVzcG9uc2libGVJZA==","name":"responsibleId","basename":"responsibleId","semanticType":"nominal","analyticType":"dimension"},{"fid":"Y3JlYXRlZERhdGU=","name":"createdDate","basename":"createdDate","semanticType":"nominal","analyticType":"dimension"},{"fid":"ZGF0ZXM=","name":"dates","basename":"dates","semanticType":"temporal","analyticType":"dimension"},{"fid":"bW9udGg=","name":"month","basename":"month","semanticType":"nominal","analyticType":"dimension"},{"fid":"gw_mea_key_fid","name":"Measure names","analyticType":"dimension","semanticType":"nominal"}],"measures":[{"fid":"cmVnaW9uQ29kZQ==","name":"regionCode","basename":"regionCode","analyticType":"measure","semanticType":"quantitative","aggName":"sum"},{"fid":"dGVhbV9udW1iZXI=","name":"team_number","basename":"team_number","analyticType":"measure","semanticType":"quantitative","aggName":"sum"},{"fid":"dHJhbnNwb25kZW50X2lk","name":"transpondent_id","basename":"transpondent_id","analyticType":"measure","semanticType":"quantitative","aggName":"sum"},{"fid":"Q29tbW9kaXR5X2lk","name":"Commodity_id","basename":"Commodity_id","analyticType":"measure","semanticType":"quantitative","aggName":"sum"},{"fid":"eWVhcg==","name":"year","basename":"year","analyticType":"measure","semanticType":"quantitative","aggName":"sum"},{"fid":"gw_count_fid","name":"Row count","analyticType":"measure","semanticType":"quantitative","aggName":"sum","computed":true,"expression":{"op":"one","params":[],"as":"gw_count_fid"}},{"fid":"gw_mea_val_fid","name":"Measure values","analyticType":"measure","semanticType":"quantitative","aggName":"sum"}],"rows":[{"fid":"bW9udGg=","name":"month","basename":"month","semanticType":"nominal","analyticType":"dimension"}],"columns":[{"fid":"gw_count_fid","name":"Row count","analyticType":"measure","semanticType":"quantitative","aggName":"sum","computed":true,"expression":{"op":"one","params":[],"as":"gw_count_fid"}}],"color":[],"opacity":[],"size":[],"shape":[],"radius":[],"theta":[],"longitude":[],"latitude":[],"geoId":[],"details":[],"filters":[],"text":[]},"layout":{"showActions":false,"showTableSummary":false,"stack":"stack","interactiveScale":false,"zeroScale":true,"size":{"mode":"auto","width":320,"height":200},"format":{},"geoKey":"name","resolve":{"x":false,"y":false,"color":false,"opacity":false,"shape":false,"size":false}},"visId":"gw_J3Fb","name":"Chart 2"}]
